var He=Object.defineProperty;var ze=(s,t,e)=>t in s?He(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var at=(s,t,e)=>(ze(s,typeof t!="symbol"?t+"":t,e),e),Le=(s,t,e)=>{if(!t.has(s))throw TypeError("Cannot "+e)};var N=(s,t,e)=>(Le(s,t,"read from private field"),e?e.call(s):t.get(s)),Ut=(s,t,e)=>{if(t.has(s))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(s):t.set(s,e)};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const tt=globalThis,At=tt.ShadowRoot&&(tt.ShadyCSS===void 0||tt.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,wt=Symbol(),jt=new WeakMap;let he=class{constructor(t,e,n){if(this._$cssResult$=!0,n!==wt)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const e=this.t;if(At&&t===void 0){const n=e!==void 0&&e.length===1;n&&(t=jt.get(e)),t===void 0&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),n&&jt.set(e,t))}return t}toString(){return this.cssText}};const Ne=s=>new he(typeof s=="string"?s:s+"",void 0,wt),Be=(s,...t)=>{const e=s.length===1?s[0]:t.reduce((n,i,r)=>n+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(i)+s[r+1],s[0]);return new he(e,s,wt)},Je=(s,t)=>{if(At)s.adoptedStyleSheets=t.map(e=>e instanceof CSSStyleSheet?e:e.styleSheet);else for(const e of t){const n=document.createElement("style"),i=tt.litNonce;i!==void 0&&n.setAttribute("nonce",i),n.textContent=e.cssText,s.appendChild(n)}},Dt=At?s=>s:s=>s instanceof CSSStyleSheet?(t=>{let e="";for(const n of t.cssRules)e+=n.cssText;return Ne(e)})(s):s;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:We,defineProperty:Ge,getOwnPropertyDescriptor:qe,getOwnPropertyNames:Ke,getOwnPropertySymbols:Xe,getPrototypeOf:Ye}=Object,S=globalThis,Ht=S.trustedTypes,Ve=Ht?Ht.emptyScript:"",ht=S.reactiveElementPolyfillSupport,G=(s,t)=>s,yt={toAttribute(s,t){switch(t){case Boolean:s=s?Ve:null;break;case Object:case Array:s=s==null?s:JSON.stringify(s)}return s},fromAttribute(s,t){let e=s;switch(t){case Boolean:e=s!==null;break;case Number:e=s===null?null:Number(s);break;case Object:case Array:try{e=JSON.parse(s)}catch{e=null}}return e}},de=(s,t)=>!We(s,t),zt={attribute:!0,type:String,converter:yt,reflect:!1,hasChanged:de};var ne,ie;(ne=Symbol.metadata)!=null||(Symbol.metadata=Symbol("metadata")),(ie=S.litPropertyMetadata)!=null||(S.litPropertyMetadata=new WeakMap);class R extends HTMLElement{static addInitializer(t){var e;this._$Ei(),((e=this.l)!=null?e:this.l=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,e=zt){if(e.state&&(e.attribute=!1),this._$Ei(),this.elementProperties.set(t,e),!e.noAccessor){const n=Symbol(),i=this.getPropertyDescriptor(t,n,e);i!==void 0&&Ge(this.prototype,t,i)}}static getPropertyDescriptor(t,e,n){var o;const{get:i,set:r}=(o=qe(this.prototype,t))!=null?o:{get(){return this[e]},set(c){this[e]=c}};return{get(){return i==null?void 0:i.call(this)},set(c){const a=i==null?void 0:i.call(this);r.call(this,c),this.requestUpdate(t,a,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){var e;return(e=this.elementProperties.get(t))!=null?e:zt}static _$Ei(){if(this.hasOwnProperty(G("elementProperties")))return;const t=Ye(this);t.finalize(),t.l!==void 0&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(G("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(G("properties"))){const e=this.properties,n=[...Ke(e),...Xe(e)];for(const i of n)this.createProperty(i,e[i])}const t=this[Symbol.metadata];if(t!==null){const e=litPropertyMetadata.get(t);if(e!==void 0)for(const[n,i]of e)this.elementProperties.set(n,i)}this._$Eh=new Map;for(const[e,n]of this.elementProperties){const i=this._$Eu(e,n);i!==void 0&&this._$Eh.set(i,e)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const n=new Set(t.flat(1/0).reverse());for(const i of n)e.unshift(Dt(i))}else t!==void 0&&e.push(Dt(t));return e}static _$Eu(t,e){const n=e.attribute;return n===!1?void 0:typeof n=="string"?n:typeof t=="string"?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var t;this._$Eg=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$ES(),this.requestUpdate(),(t=this.constructor.l)==null||t.forEach(e=>e(this))}addController(t){var e,n;((e=this._$E_)!=null?e:this._$E_=new Set).add(t),this.renderRoot!==void 0&&this.isConnected&&((n=t.hostConnected)==null||n.call(t))}removeController(t){var e;(e=this._$E_)==null||e.delete(t)}_$ES(){const t=new Map,e=this.constructor.elementProperties;for(const n of e.keys())this.hasOwnProperty(n)&&(t.set(n,this[n]),delete this[n]);t.size>0&&(this._$Ep=t)}createRenderRoot(){var e;const t=(e=this.shadowRoot)!=null?e:this.attachShadow(this.constructor.shadowRootOptions);return Je(t,this.constructor.elementStyles),t}connectedCallback(){var t,e;(t=this.renderRoot)!=null||(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$E_)==null||e.forEach(n=>{var i;return(i=n.hostConnected)==null?void 0:i.call(n)})}enableUpdating(t){}disconnectedCallback(){var t;(t=this._$E_)==null||t.forEach(e=>{var n;return(n=e.hostDisconnected)==null?void 0:n.call(e)})}attributeChangedCallback(t,e,n){this._$AK(t,n)}_$EO(t,e){var r;const n=this.constructor.elementProperties.get(t),i=this.constructor._$Eu(t,n);if(i!==void 0&&n.reflect===!0){const o=(((r=n.converter)==null?void 0:r.toAttribute)!==void 0?n.converter:yt).toAttribute(e,n.type);this._$Em=t,o==null?this.removeAttribute(i):this.setAttribute(i,o),this._$Em=null}}_$AK(t,e){var r;const n=this.constructor,i=n._$Eh.get(t);if(i!==void 0&&this._$Em!==i){const o=n.getPropertyOptions(i),c=typeof o.converter=="function"?{fromAttribute:o.converter}:((r=o.converter)==null?void 0:r.fromAttribute)!==void 0?o.converter:yt;this._$Em=i,this[i]=c.fromAttribute(e,o.type),this._$Em=null}}requestUpdate(t,e,n){var i;if(t!==void 0){if(n!=null||(n=this.constructor.getPropertyOptions(t)),!((i=n.hasChanged)!=null?i:de)(this[t],e))return;this.C(t,e,n)}this.isUpdatePending===!1&&(this._$Eg=this._$EP())}C(t,e,n){var i;this._$AL.has(t)||this._$AL.set(t,e),n.reflect===!0&&this._$Em!==t&&((i=this._$ET)!=null?i:this._$ET=new Set).add(t)}async _$EP(){this.isUpdatePending=!0;try{await this._$Eg}catch(e){Promise.reject(e)}const t=this.scheduleUpdate();return t!=null&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var n,i;if(!this.isUpdatePending)return;if(!this.hasUpdated){if((n=this.renderRoot)!=null||(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[o,c]of this._$Ep)this[o]=c;this._$Ep=void 0}const r=this.constructor.elementProperties;if(r.size>0)for(const[o,c]of r)c.wrapped!==!0||this._$AL.has(o)||this[o]===void 0||this.C(o,this[o],c)}let t=!1;const e=this._$AL;try{t=this.shouldUpdate(e),t?(this.willUpdate(e),(i=this._$E_)==null||i.forEach(r=>{var o;return(o=r.hostUpdate)==null?void 0:o.call(r)}),this.update(e)):this._$Ej()}catch(r){throw t=!1,this._$Ej(),r}t&&this._$AE(e)}willUpdate(t){}_$AE(t){var e;(e=this._$E_)==null||e.forEach(n=>{var i;return(i=n.hostUpdated)==null?void 0:i.call(n)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$Ej(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$Eg}shouldUpdate(t){return!0}update(t){this._$ET&&(this._$ET=this._$ET.forEach(e=>this._$EO(e,this[e]))),this._$Ej()}updated(t){}firstUpdated(t){}}var re;R.elementStyles=[],R.shadowRootOptions={mode:"open"},R[G("elementProperties")]=new Map,R[G("finalized")]=new Map,ht==null||ht({ReactiveElement:R}),((re=S.reactiveElementVersions)!=null?re:S.reactiveElementVersions=[]).push("2.0.3");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const q=globalThis,st=q.trustedTypes,Lt=st?st.createPolicy("lit-html",{createHTML:s=>s}):void 0,le="$lit$",$=`lit$${(Math.random()+"").slice(9)}$`,ue="?"+$,Ze=`<${ue}>`,C=document,X=()=>C.createComment(""),Y=s=>s===null||typeof s!="object"&&typeof s!="function",fe=Array.isArray,Fe=s=>fe(s)||typeof(s==null?void 0:s[Symbol.iterator])=="function",dt=`[ 	
\f\r]`,B=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Nt=/-->/g,Bt=/>/g,w=RegExp(`>|${dt}(?:([^\\s"'>=/]+)(${dt}*=${dt}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),Jt=/'/g,Wt=/"/g,pe=/^(?:script|style|textarea|title)$/i,Qe=s=>(t,...e)=>({_$litType$:s,strings:t,values:e}),ye=Qe(1),j=Symbol.for("lit-noChange"),g=Symbol.for("lit-nothing"),Gt=new WeakMap,x=C.createTreeWalker(C,129);function ge(s,t){if(!Array.isArray(s)||!s.hasOwnProperty("raw"))throw Error("invalid template strings array");return Lt!==void 0?Lt.createHTML(t):t}const ts=(s,t)=>{const e=s.length-1,n=[];let i,r=t===2?"<svg>":"",o=B;for(let c=0;c<e;c++){const a=s[c];let d,l,h=-1,u=0;for(;u<a.length&&(o.lastIndex=u,l=o.exec(a),l!==null);)u=o.lastIndex,o===B?l[1]==="!--"?o=Nt:l[1]!==void 0?o=Bt:l[2]!==void 0?(pe.test(l[2])&&(i=RegExp("</"+l[2],"g")),o=w):l[3]!==void 0&&(o=w):o===w?l[0]===">"?(o=i!=null?i:B,h=-1):l[1]===void 0?h=-2:(h=o.lastIndex-l[2].length,d=l[1],o=l[3]===void 0?w:l[3]==='"'?Wt:Jt):o===Wt||o===Jt?o=w:o===Nt||o===Bt?o=B:(o=w,i=void 0);const f=o===w&&s[c+1].startsWith("/>")?" ":"";r+=o===B?a+Ze:h>=0?(n.push(d),a.slice(0,h)+le+a.slice(h)+$+f):a+$+(h===-2?c:f)}return[ge(s,r+(s[e]||"<?>")+(t===2?"</svg>":"")),n]};class V{constructor({strings:t,_$litType$:e},n){let i;this.parts=[];let r=0,o=0;const c=t.length-1,a=this.parts,[d,l]=ts(t,e);if(this.el=V.createElement(d,n),x.currentNode=this.el.content,e===2){const h=this.el.content.firstChild;h.replaceWith(...h.childNodes)}for(;(i=x.nextNode())!==null&&a.length<c;){if(i.nodeType===1){if(i.hasAttributes())for(const h of i.getAttributeNames())if(h.endsWith(le)){const u=l[o++],f=i.getAttribute(h).split($),p=/([.?@])?(.*)/.exec(u);a.push({type:1,index:r,name:p[2],strings:f,ctor:p[1]==="."?ss:p[1]==="?"?ns:p[1]==="@"?is:ot}),i.removeAttribute(h)}else h.startsWith($)&&(a.push({type:6,index:r}),i.removeAttribute(h));if(pe.test(i.tagName)){const h=i.textContent.split($),u=h.length-1;if(u>0){i.textContent=st?st.emptyScript:"";for(let f=0;f<u;f++)i.append(h[f],X()),x.nextNode(),a.push({type:2,index:++r});i.append(h[u],X())}}}else if(i.nodeType===8)if(i.data===ue)a.push({type:2,index:r});else{let h=-1;for(;(h=i.data.indexOf($,h+1))!==-1;)a.push({type:7,index:r}),h+=$.length-1}r++}}static createElement(t,e){const n=C.createElement("template");return n.innerHTML=t,n}}function D(s,t,e=s,n){var o,c,a;if(t===j)return t;let i=n!==void 0?(o=e._$Co)==null?void 0:o[n]:e._$Cl;const r=Y(t)?void 0:t._$litDirective$;return(i==null?void 0:i.constructor)!==r&&((c=i==null?void 0:i._$AO)==null||c.call(i,!1),r===void 0?i=void 0:(i=new r(s),i._$AT(s,e,n)),n!==void 0?((a=e._$Co)!=null?a:e._$Co=[])[n]=i:e._$Cl=i),i!==void 0&&(t=D(s,i._$AS(s,t.values),i,n)),t}class es{constructor(t,e){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){var d;const{el:{content:e},parts:n}=this._$AD,i=((d=t==null?void 0:t.creationScope)!=null?d:C).importNode(e,!0);x.currentNode=i;let r=x.nextNode(),o=0,c=0,a=n[0];for(;a!==void 0;){if(o===a.index){let l;a.type===2?l=new F(r,r.nextSibling,this,t):a.type===1?l=new a.ctor(r,a.name,a.strings,this,t):a.type===6&&(l=new rs(r,this,t)),this._$AV.push(l),a=n[++c]}o!==(a==null?void 0:a.index)&&(r=x.nextNode(),o++)}return x.currentNode=C,i}p(t){let e=0;for(const n of this._$AV)n!==void 0&&(n.strings!==void 0?(n._$AI(t,n,e),e+=n.strings.length-2):n._$AI(t[e])),e++}}class F{get _$AU(){var t,e;return(e=(t=this._$AM)==null?void 0:t._$AU)!=null?e:this._$Cv}constructor(t,e,n,i){var r;this.type=2,this._$AH=g,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=n,this.options=i,this._$Cv=(r=i==null?void 0:i.isConnected)!=null?r:!0}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return e!==void 0&&(t==null?void 0:t.nodeType)===11&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=D(this,t,e),Y(t)?t===g||t==null||t===""?(this._$AH!==g&&this._$AR(),this._$AH=g):t!==this._$AH&&t!==j&&this._(t):t._$litType$!==void 0?this.g(t):t.nodeType!==void 0?this.$(t):Fe(t)?this.T(t):this._(t)}k(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}$(t){this._$AH!==t&&(this._$AR(),this._$AH=this.k(t))}_(t){this._$AH!==g&&Y(this._$AH)?this._$AA.nextSibling.data=t:this.$(C.createTextNode(t)),this._$AH=t}g(t){var r;const{values:e,_$litType$:n}=t,i=typeof n=="number"?this._$AC(t):(n.el===void 0&&(n.el=V.createElement(ge(n.h,n.h[0]),this.options)),n);if(((r=this._$AH)==null?void 0:r._$AD)===i)this._$AH.p(e);else{const o=new es(i,this),c=o.u(this.options);o.p(e),this.$(c),this._$AH=o}}_$AC(t){let e=Gt.get(t.strings);return e===void 0&&Gt.set(t.strings,e=new V(t)),e}T(t){fe(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let n,i=0;for(const r of t)i===e.length?e.push(n=new F(this.k(X()),this.k(X()),this,this.options)):n=e[i],n._$AI(r),i++;i<e.length&&(this._$AR(n&&n._$AB.nextSibling,i),e.length=i)}_$AR(t=this._$AA.nextSibling,e){var n;for((n=this._$AP)==null?void 0:n.call(this,!1,!0,e);t&&t!==this._$AB;){const i=t.nextSibling;t.remove(),t=i}}setConnected(t){var e;this._$AM===void 0&&(this._$Cv=t,(e=this._$AP)==null||e.call(this,t))}}class ot{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,e,n,i,r){this.type=1,this._$AH=g,this._$AN=void 0,this.element=t,this.name=e,this._$AM=i,this.options=r,n.length>2||n[0]!==""||n[1]!==""?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=g}_$AI(t,e=this,n,i){const r=this.strings;let o=!1;if(r===void 0)t=D(this,t,e,0),o=!Y(t)||t!==this._$AH&&t!==j,o&&(this._$AH=t);else{const c=t;let a,d;for(t=r[0],a=0;a<r.length-1;a++)d=D(this,c[n+a],e,a),d===j&&(d=this._$AH[a]),o||(o=!Y(d)||d!==this._$AH[a]),d===g?t=g:t!==g&&(t+=(d!=null?d:"")+r[a+1]),this._$AH[a]=d}o&&!i&&this.O(t)}O(t){t===g?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t!=null?t:"")}}class ss extends ot{constructor(){super(...arguments),this.type=3}O(t){this.element[this.name]=t===g?void 0:t}}class ns extends ot{constructor(){super(...arguments),this.type=4}O(t){this.element.toggleAttribute(this.name,!!t&&t!==g)}}class is extends ot{constructor(t,e,n,i,r){super(t,e,n,i,r),this.type=5}_$AI(t,e=this){var o;if((t=(o=D(this,t,e,0))!=null?o:g)===j)return;const n=this._$AH,i=t===g&&n!==g||t.capture!==n.capture||t.once!==n.once||t.passive!==n.passive,r=t!==g&&(n===g||i);i&&this.element.removeEventListener(this.name,this,n),r&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var e,n;typeof this._$AH=="function"?this._$AH.call((n=(e=this.options)==null?void 0:e.host)!=null?n:this.element,t):this._$AH.handleEvent(t)}}class rs{constructor(t,e,n){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(t){D(this,t)}}const lt=q.litHtmlPolyfillSupport;var oe;lt==null||lt(V,F),((oe=q.litHtmlVersions)!=null?oe:q.litHtmlVersions=[]).push("3.1.1");const _e=(s,t,e)=>{var r,o;const n=(r=e==null?void 0:e.renderBefore)!=null?r:t;let i=n._$litPart$;if(i===void 0){const c=(o=e==null?void 0:e.renderBefore)!=null?o:null;n._$litPart$=i=new F(t.insertBefore(X(),c),c,void 0,e!=null?e:{})}return i._$AI(s),i};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class K extends R{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var e,n;const t=super.createRenderRoot();return(n=(e=this.renderOptions).renderBefore)!=null||(e.renderBefore=t.firstChild),t}update(t){const e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=_e(e,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),(t=this._$Do)==null||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),(t=this._$Do)==null||t.setConnected(!1)}render(){return j}}var ce;K._$litElement$=!0,K.finalized=!0,(ce=globalThis.litElementHydrateSupport)==null||ce.call(globalThis,{LitElement:K});const ut=globalThis.litElementPolyfillSupport;ut==null||ut({LitElement:K});var ae;((ae=globalThis.litElementVersions)!=null?ae:globalThis.litElementVersions=[]).push("4.0.3");function os(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}function cs(){const s=os();if(s.__xstate__)return s.__xstate__}const as=s=>{if(typeof window>"u")return;const t=cs();t&&t.register(s)};class qt{constructor(t){this._process=t,this._active=!1,this._current=null,this._last=null}start(){this._active=!0,this.flush()}clear(){this._current&&(this._current.next=null,this._last=this._current)}enqueue(t){const e={value:t,next:null};if(this._current){this._last.next=e,this._last=e;return}this._current=e,this._last=e,this._active&&this.flush()}flush(){for(;this._current;){const t=this._current;this._process(t.value),this._current=t.next}this._last=null}}const me=".",hs="",ve="",ds="#",ls="*",$e="xstate.init",gt="xstate.stop";function us(s,t){return{type:`xstate.after.${s}.${t}`}}function _t(s,t){return{type:`xstate.done.state.${s}`,output:t}}function fs(s,t){return{type:`xstate.done.actor.${s}`,output:t}}function ps(s,t){return{type:`xstate.error.actor.${s}`,error:t}}function be(s){return{type:$e,input:s}}function v(s){setTimeout(()=>{throw s})}const ys=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Kt(s,t){return`${s.sessionId}.${t}`}let gs=0;function _s(s,t){var l;const e=new Map,n=new Map,i=new WeakMap,r=new Set,o={},c=t.clock,a={schedule:(h,u,f,p,y=Math.random().toString(36).slice(2))=>{const m={source:h,target:u,event:f,delay:p,id:y,startedAt:Date.now()},O=Kt(h,y);d._snapshot._scheduledEvents[O]=m;const De=c.setTimeout(()=>{delete o[O],delete d._snapshot._scheduledEvents[O],d._relay(h,u,f)},p);o[O]=De},cancel:(h,u)=>{const f=Kt(h,u),p=o[f];delete o[f],delete d._snapshot._scheduledEvents[f],c.clearTimeout(p)},cancelAll:h=>{for(const u in d._snapshot._scheduledEvents){const f=d._snapshot._scheduledEvents[u];f.source===h&&a.cancel(h,f.id)}}},d={_snapshot:{_scheduledEvents:(l=(t==null?void 0:t.snapshot)&&t.snapshot.scheduler)!=null?l:{}},_bookId:()=>`x:${gs++}`,_register:(h,u)=>(e.set(h,u),h),_unregister:h=>{e.delete(h.sessionId);const u=i.get(h);u!==void 0&&(n.delete(u),i.delete(h))},get:h=>n.get(h),_set:(h,u)=>{const f=n.get(h);if(f&&f!==u)throw new Error(`Actor with system ID '${h}' already exists.`);n.set(h,u),i.set(u,h)},inspect:h=>{r.add(h)},_sendInspectionEvent:h=>{const u={...h,rootId:s.sessionId};r.forEach(f=>{var p;return(p=f.next)==null?void 0:p.call(f,u)})},_relay:(h,u,f)=>{d._sendInspectionEvent({type:"@xstate.event",sourceRef:h,actorRef:u,event:f}),u._send(f)},scheduler:a,getSnapshot:()=>({_scheduledEvents:{...d._snapshot._scheduledEvents}}),start:()=>{const h=d._snapshot._scheduledEvents;d._snapshot._scheduledEvents={};for(const u in h){const{source:f,target:p,event:y,delay:m,id:O}=h[u];a.schedule(f,p,y,m,O)}}};return d}function Se(s,t){const e=Xt(s),n=Xt(t);return typeof n=="string"?typeof e=="string"?n===e:!1:typeof e=="string"?e in n:Object.keys(e).every(i=>i in n?Se(e[i],n[i]):!1)}function Et(s){if(we(s))return s;let t=[],e="";for(let n=0;n<s.length;n++){switch(s.charCodeAt(n)){case 92:e+=s[n+1],n++;continue;case 46:t.push(e),e="";continue}e+=s[n]}return t.push(e),t}function Xt(s){if(Xs(s))return s.value;if(typeof s!="string")return s;const t=Et(s);return ms(t)}function ms(s){if(s.length===1)return s[0];const t={};let e=t;for(let n=0;n<s.length-1;n++)if(n===s.length-2)e[s[n]]=s[n+1];else{const i=e;e={},i[s[n]]=e}return t}function Yt(s,t){const e={},n=Object.keys(s);for(let i=0;i<n.length;i++){const r=n[i];e[r]=t(s[r],r,s,i)}return e}function Ae(s){return we(s)?s:[s]}function b(s){return s===void 0?[]:Ae(s)}function mt(s,t,e,n){return typeof s=="function"?s({context:t,event:e,self:n}):s}function we(s){return Array.isArray(s)}function vs(s){return s.type.startsWith("xstate.error.actor")}function P(s){return Ae(s).map(t=>typeof t>"u"||typeof t=="string"?{target:t}:t)}function Ee(s){if(!(s===void 0||s===hs))return b(s)}function Vt(s,t,e){var r,o,c;const n=typeof s=="object",i=n?s:void 0;return{next:(r=n?s.next:s)==null?void 0:r.bind(i),error:(o=n?s.error:t)==null?void 0:o.bind(i),complete:(c=n?s.complete:e)==null?void 0:c.bind(i)}}function Zt(s,t){return`${t}.${s}`}function xt(s,t){const e=t.match(/^xstate\.invoke\.(\d+)\.(.*)/);if(!e)return s.implementations.actors[t];const[,n,i]=e,o=s.getStateNodeById(i).config.invoke;return(Array.isArray(o)?o[n]:o).src}const Tt=1;let _=function(s){return s[s.NotStarted=0]="NotStarted",s[s.Running=1]="Running",s[s.Stopped=2]="Stopped",s}({});const $s={clock:{setTimeout:(s,t)=>setTimeout(s,t),clearTimeout:s=>clearTimeout(s)},logger:console.log.bind(console),devTools:!1};class bs{constructor(t,e){var h,u;this.logic=t,this._snapshot=void 0,this.clock=void 0,this.options=void 0,this.id=void 0,this.mailbox=new qt(this._process.bind(this)),this.observers=new Set,this.logger=void 0,this._processingStatus=_.NotStarted,this._parent=void 0,this._syncSnapshot=void 0,this.ref=void 0,this._actorScope=void 0,this._systemId=void 0,this.sessionId=void 0,this.system=void 0,this._doneEvent=void 0,this.src=void 0,this._deferred=[];const n={...$s,...e},{clock:i,logger:r,parent:o,syncSnapshot:c,id:a,systemId:d,inspect:l}=n;this.system=o?o.system:_s(this,{clock:i}),l&&!o&&this.system.inspect(Vt(l)),this.sessionId=this.system._bookId(),this.id=a!=null?a:this.sessionId,this.logger=r,this.clock=i,this._parent=o,this._syncSnapshot=c,this.options=n,this.src=(h=n.src)!=null?h:t,this.ref=this,this._actorScope={self:this,id:this.id,sessionId:this.sessionId,logger:this.logger,defer:f=>{this._deferred.push(f)},system:this.system,stopChild:f=>{if(f._parent!==this)throw new Error(`Cannot stop child actor ${f.id} of ${this.id} because it is not a child`);f._stop()}},this.send=this.send.bind(this),this.system._sendInspectionEvent({type:"@xstate.actor",actorRef:this}),d&&(this._systemId=d,this.system._set(d,this)),this._initState((u=e==null?void 0:e.snapshot)!=null?u:e==null?void 0:e.state),d&&this._snapshot.status!=="active"&&this.system._unregister(this)}_initState(t){var e;try{this._snapshot=t?this.logic.restoreSnapshot?this.logic.restoreSnapshot(t,this._actorScope):t:this.logic.getInitialSnapshot(this._actorScope,(e=this.options)==null?void 0:e.input)}catch(n){this._snapshot={status:"error",output:void 0,error:n}}}update(t,e){var i,r;this._snapshot=t;let n;for(;n=this._deferred.shift();)try{n()}catch(o){this._deferred.length=0,this._snapshot={...t,status:"error",error:o}}switch(this._snapshot.status){case"active":for(const o of this.observers)try{(i=o.next)==null||i.call(o,t)}catch(c){v(c)}break;case"done":for(const o of this.observers)try{(r=o.next)==null||r.call(o,t)}catch(c){v(c)}this._stopProcedure(),this._complete(),this._doneEvent=fs(this.id,this._snapshot.output),this._parent&&this.system._relay(this,this._parent,this._doneEvent);break;case"error":this._error(this._snapshot.error);break}this.system._sendInspectionEvent({type:"@xstate.snapshot",actorRef:this,event:e,snapshot:t})}subscribe(t,e,n){var r;const i=Vt(t,e,n);if(this._processingStatus!==_.Stopped)this.observers.add(i);else switch(this._snapshot.status){case"done":try{(r=i.complete)==null||r.call(i)}catch(o){v(o)}break;case"error":{const o=this._snapshot.error;if(!i.error)v(o);else try{i.error(o)}catch(c){v(c)}break}}return{unsubscribe:()=>{this.observers.delete(i)}}}start(){if(this._processingStatus===_.Running)return this;this._syncSnapshot&&this.subscribe({next:n=>{n.status==="active"&&this.system._relay(this,this._parent,{type:`xstate.snapshot.${this.id}`,snapshot:n})},error:()=>{}}),this.system._register(this.sessionId,this),this._systemId&&this.system._set(this._systemId,this),this._processingStatus=_.Running;const t=be(this.options.input);switch(this.system._sendInspectionEvent({type:"@xstate.event",sourceRef:this._parent,actorRef:this,event:t}),this._snapshot.status){case"done":return this.update(this._snapshot,t),this;case"error":return this._error(this._snapshot.error),this}if(this._parent||this.system.start(),this.logic.start)try{this.logic.start(this._snapshot,this._actorScope)}catch(n){return this._snapshot={...this._snapshot,status:"error",error:n},this._error(n),this}return this.update(this._snapshot,t),this.options.devTools&&this.attachDevTools(),this.mailbox.start(),this}_process(t){let e,n;try{e=this.logic.transition(this._snapshot,t,this._actorScope)}catch(i){n={err:i}}if(n){const{err:i}=n;this._snapshot={...this._snapshot,status:"error",error:i},this._error(i);return}this.update(e,t),t.type===gt&&(this._stopProcedure(),this._complete())}_stop(){return this._processingStatus===_.Stopped?this:(this.mailbox.clear(),this._processingStatus===_.NotStarted?(this._processingStatus=_.Stopped,this):(this.mailbox.enqueue({type:gt}),this))}stop(){if(this._parent)throw new Error("A non-root actor cannot be stopped directly.");return this._stop()}_complete(){var t;for(const e of this.observers)try{(t=e.complete)==null||t.call(e)}catch(n){v(n)}this.observers.clear()}_reportError(t){if(!this.observers.size){this._parent||v(t);return}let e=!1;for(const n of this.observers){const i=n.error;e||(e=!i);try{i==null||i(t)}catch(r){v(r)}}this.observers.clear(),e&&v(t)}_error(t){this._stopProcedure(),this._reportError(t),this._parent&&this.system._relay(this,this._parent,ps(this.id,t))}_stopProcedure(){return this._processingStatus!==_.Running?this:(this.system.scheduler.cancelAll(this),this.mailbox.clear(),this.mailbox=new qt(this._process.bind(this)),this._processingStatus=_.Stopped,this.system._unregister(this),this)}_send(t){this._processingStatus!==_.Stopped&&this.mailbox.enqueue(t)}send(t){this.system._relay(void 0,this,t)}attachDevTools(){const{devTools:t}=this.options;t&&(typeof t=="function"?t:as)(this)}toJSON(){return{xstate$$type:Tt,id:this.id}}getPersistedSnapshot(t){return this.logic.getPersistedSnapshot(this._snapshot,t)}[ys](){return this}getSnapshot(){return this._snapshot}}function Z(s,t){return new bs(s,t)}function Ss(s,t,e,n,{sendId:i}){const r=typeof i=="function"?i(e,n):i;return[t,r]}function As(s,t){s.defer(()=>{s.system.scheduler.cancel(s.self,t)})}function ws(s){function t(e,n){}return t.type="xstate.cancel",t.sendId=s,t.resolve=Ss,t.execute=As,t}function Es(s,t,e,n,{id:i,systemId:r,src:o,input:c,syncSnapshot:a}){const d=typeof o=="string"?xt(t.machine,o):o,l=typeof i=="function"?i(e):i;let h;return d&&(h=Z(d,{id:l,src:o,parent:s.self,syncSnapshot:a,systemId:r,input:typeof c=="function"?c({context:t.context,event:e.event,self:s.self}):c})),[I(t,{children:{...t.children,[l]:h}}),{id:i,actorRef:h}]}function xs(s,{id:t,actorRef:e}){e&&s.defer(()=>{e._processingStatus!==_.Stopped&&e.start()})}function Ts(...[s,{id:t,systemId:e,input:n,syncSnapshot:i=!1}={}]){function r(o,c){}return r.type="snapshot.spawnChild",r.id=t,r.systemId=e,r.src=s,r.input=n,r.syncSnapshot=i,r.resolve=Es,r.execute=xs,r}function ks(s,t,e,n,{actorRef:i}){const r=typeof i=="function"?i(e,n):i,o=typeof r=="string"?t.children[r]:r;let c=t.children;return o&&(c={...c},delete c[o.id]),[I(t,{children:c}),o]}function Cs(s,t){if(t){if(s.system._unregister(t),t._processingStatus!==_.Running){s.stopChild(t);return}s.defer(()=>{s.stopChild(t)})}}function xe(s){function t(e,n){}return t.type="xstate.stopChild",t.actorRef=s,t.resolve=ks,t.execute=Cs,t}function kt(s,t,e,n){const{machine:i}=n,r=typeof s=="function",o=r?s:i.implementations.guards[typeof s=="string"?s:s.type];if(!r&&!o)throw new Error(`Guard '${typeof s=="string"?s:s.type}' is not implemented.'.`);if(typeof o!="function")return kt(o,t,e,n);const c={context:t,event:e},a=r||typeof s=="string"?void 0:"params"in s?typeof s.params=="function"?s.params({context:t,event:e}):s.params:void 0;return"check"in o?o.check(n,c,o):o(c,a)}const Ct=s=>s.type==="atomic"||s.type==="final";function H(s){return Object.values(s.states).filter(t=>t.type!=="history")}function Q(s,t){const e=[];if(t===s)return e;let n=s.parent;for(;n&&n!==t;)e.push(n),n=n.parent;return e}function nt(s){const t=new Set(s),e=ke(t);for(const n of t)if(n.type==="compound"&&(!e.get(n)||!e.get(n).length))Ft(n).forEach(i=>t.add(i));else if(n.type==="parallel"){for(const i of H(n))if(i.type!=="history"&&!t.has(i)){const r=Ft(i);for(const o of r)t.add(o)}}for(const n of t){let i=n.parent;for(;i;)t.add(i),i=i.parent}return t}function Te(s,t){const e=t.get(s);if(!e)return{};if(s.type==="compound"){const i=e[0];if(i){if(Ct(i))return i.key}else return{}}const n={};for(const i of e)n[i.key]=Te(i,t);return n}function ke(s){const t=new Map;for(const e of s)t.has(e)||t.set(e,[]),e.parent&&(t.has(e.parent)||t.set(e.parent,[]),t.get(e.parent).push(e));return t}function Ce(s,t){const e=nt(t);return Te(s,ke(e))}function It(s,t){return t.type==="compound"?H(t).some(e=>e.type==="final"&&s.has(e)):t.type==="parallel"?H(t).every(e=>It(s,e)):t.type==="final"}const ct=s=>s[0]===ds;function Is(s,t){return s.transitions.get(t)||[...s.transitions.keys()].filter(n=>{if(n===ls)return!0;if(!n.endsWith(".*"))return!1;const i=n.split("."),r=t.split(".");for(let o=0;o<i.length;o++){const c=i[o],a=r[o];if(c==="*")return o===i.length-1;if(c!==a)return!1}return!0}).sort((n,i)=>i.length-n.length).flatMap(n=>s.transitions.get(n))}function Os(s){const t=s.config.after;if(!t)return[];const e=(i,r)=>{const o=us(i,s.id),c=o.type;return s.entry.push(nn(o,{id:c,delay:i})),s.exit.push(ws(c)),c};return Object.keys(t).flatMap((i,r)=>{const o=t[i],c=typeof o=="string"?{target:o}:o,a=Number.isNaN(+i)?i:+i,d=e(a);return b(c).map(l=>({...l,event:d,delay:a}))}).map(i=>{const{delay:r}=i;return{...E(s,i.event,i),delay:r}})}function E(s,t,e){var c;const n=Ee(e.target),i=(c=e.reenter)!=null?c:!1,r=Ps(s,n),o={...e,actions:b(e.actions),guard:e.guard,target:r,source:s,reenter:i,eventType:t,toJSON:()=>({...o,source:`#${s.id}`,target:r?r.map(a=>`#${a.id}`):void 0})};return o}function Ms(s){const t=new Map;if(s.config.on)for(const e of Object.keys(s.config.on)){if(e===ve)throw new Error('Null events ("") cannot be specified as a transition key. Use `always: { ... }` instead.');const n=s.config.on[e];t.set(e,P(n).map(i=>E(s,e,i)))}if(s.config.onDone){const e=`xstate.done.state.${s.id}`;t.set(e,P(s.config.onDone).map(n=>E(s,e,n)))}for(const e of s.invoke){if(e.onDone){const n=`xstate.done.actor.${e.id}`;t.set(n,P(e.onDone).map(i=>E(s,n,i)))}if(e.onError){const n=`xstate.error.actor.${e.id}`;t.set(n,P(e.onError).map(i=>E(s,n,i)))}if(e.onSnapshot){const n=`xstate.snapshot.${e.id}`;t.set(n,P(e.onSnapshot).map(i=>E(s,n,i)))}}for(const e of s.after){let n=t.get(e.eventType);n||(n=[],t.set(e.eventType,n)),n.push(e)}return t}function Rs(s,t){const e=typeof t=="string"?s.states[t]:t?s.states[t.target]:void 0;if(!e&&t)throw new Error(`Initial state node "${t}" not found on parent state node #${s.id}`);const n={source:s,actions:!t||typeof t=="string"?[]:b(t.actions),eventType:null,reenter:!1,target:e?[e]:[],toJSON:()=>({...n,source:`#${s.id}`,target:e?[`#${e.id}`]:[]})};return n}function Ps(s,t){if(t!==void 0)return t.map(e=>{if(typeof e!="string")return e;if(ct(e))return s.machine.getStateNodeById(e);const n=e[0]===me;if(n&&!s.parent)return it(s,e.slice(1));const i=n?s.key+e:e;if(s.parent)try{return it(s.parent,i)}catch(r){throw new Error(`Invalid transition definition for state node '${s.id}':
${r.message}`)}else throw new Error(`Invalid target: "${e}" is not a valid target from the root node. Did you mean ".${e}"?`)})}function Ie(s){const t=Ee(s.config.target);return t?{target:t.map(e=>typeof e=="string"?it(s.parent,e):e)}:s.parent.initial}function T(s){return s.type==="history"}function Ft(s){const t=Oe(s);for(const e of t)for(const n of Q(e,s))t.add(n);return t}function Oe(s){const t=new Set;function e(n){if(!t.has(n)){if(t.add(n),n.type==="compound")e(n.initial.target[0]);else if(n.type==="parallel")for(const i of H(n))e(i)}}return e(s),t}function z(s,t){if(ct(t))return s.machine.getStateNodeById(t);if(!s.states)throw new Error(`Unable to retrieve child state '${t}' from '${s.id}'; no child states exist.`);const e=s.states[t];if(!e)throw new Error(`Child state '${t}' does not exist on '${s.id}'`);return e}function it(s,t){if(typeof t=="string"&&ct(t))try{return s.machine.getStateNodeById(t)}catch{}const e=Et(t).slice();let n=s;for(;e.length;){const i=e.shift();if(!i.length)break;n=z(n,i)}return n}function rt(s,t){if(typeof t=="string")return[s,s.states[t]];const e=Object.keys(t),n=e.map(i=>z(s,i)).filter(Boolean);return[s.machine.root,s].concat(n,e.reduce((i,r)=>{const o=z(s,r);if(!o)return i;const c=rt(o,t[r]);return i.concat(c)},[]))}function Us(s,t,e,n){const r=z(s,t).next(e,n);return!r||!r.length?s.next(e,n):r}function js(s,t,e,n){const i=Object.keys(t),r=z(s,i[0]),o=Ot(r,t[i[0]],e,n);return!o||!o.length?s.next(e,n):o}function Ds(s,t,e,n){const i=[];for(const r of Object.keys(t)){const o=t[r];if(!o)continue;const c=z(s,r),a=Ot(c,o,e,n);a&&i.push(...a)}return i.length?i:s.next(e,n)}function Ot(s,t,e,n){return typeof t=="string"?Us(s,t,e,n):Object.keys(t).length===1?js(s,t,e,n):Ds(s,t,e,n)}function Hs(s){return Object.keys(s.states).map(t=>s.states[t]).filter(t=>t.type==="history")}function A(s,t){let e=s;for(;e.parent&&e.parent!==t;)e=e.parent;return e.parent===t}function zs(s,t){const e=new Set(s),n=new Set(t);for(const i of e)if(n.has(i))return!0;for(const i of n)if(e.has(i))return!0;return!1}function Me(s,t,e){const n=new Set;for(const i of s){let r=!1;const o=new Set;for(const c of n)if(zs(vt([i],t,e),vt([c],t,e)))if(A(i.source,c.source))o.add(c);else{r=!0;break}if(!r){for(const c of o)n.delete(c);n.add(i)}}return Array.from(n)}function Ls(s){const[t,...e]=s;for(const n of Q(t,void 0))if(e.every(i=>A(i,n)))return n}function Mt(s,t){if(!s.target)return[];const e=new Set;for(const n of s.target)if(T(n))if(t[n.id])for(const i of t[n.id])e.add(i);else for(const i of Mt(Ie(n),t))e.add(i);else e.add(n);return[...e]}function Re(s,t){const e=Mt(s,t);if(!e)return;if(!s.reenter&&e.every(i=>i===s.source||A(i,s.source)))return s.source;const n=Ls(e.concat(s.source));if(n)return n;if(!s.reenter)return s.source.machine.root}function vt(s,t,e){var i;const n=new Set;for(const r of s)if((i=r.target)!=null&&i.length){const o=Re(r,e);r.reenter&&r.source===o&&n.add(o);for(const c of t)A(c,o)&&n.add(c)}return[...n]}function Ns(s,t){if(s.length!==t.size)return!1;for(const e of s)if(!t.has(e))return!1;return!0}function $t(s,t,e,n,i,r){if(!s.length)return t;const o=new Set(t._nodes);let c=t.historyValue;const a=Me(s,o,c);let d=t;i||([d,c]=Gs(d,n,e,a,o,c,r)),d=L(d,n,e,a.flatMap(h=>h.actions),r),d=Js(d,n,e,a,o,r,c,i);const l=[...o];d.status==="done"&&(d=L(d,n,e,l.sort((h,u)=>u.order-h.order).flatMap(h=>h.exit),r));try{return c===t.historyValue&&Ns(t._nodes,o)?d:I(d,{_nodes:l,historyValue:c})}catch(h){throw h}}function Bs(s,t,e,n,i){if(!n.output)return;const r=_t(i.id,i.output&&i.parent?mt(i.output,s.context,t,e.self):void 0);return mt(n.output,s.context,r,e.self)}function Js(s,t,e,n,i,r,o,c){let a=s;const d=new Set,l=new Set;Ws(n,o,l,d),c&&l.add(s.machine.root);const h=new Set;for(const u of[...d].sort((f,p)=>f.order-p.order)){i.add(u);const f=[];f.push(...u.entry);for(const p of u.invoke)f.push(Ts(p.src,{...p,syncSnapshot:!!p.onSnapshot}));if(l.has(u)){const p=u.initial.actions;f.push(...p)}if(a=L(a,t,e,f,r,u.invoke.map(p=>p.id)),u.type==="final"){const p=u.parent;let y=(p==null?void 0:p.type)==="parallel"?p:p==null?void 0:p.parent,m=y||u;for((p==null?void 0:p.type)==="compound"&&r.push(_t(p.id,u.output?mt(u.output,a.context,t,e.self):void 0));(y==null?void 0:y.type)==="parallel"&&!h.has(y)&&It(i,y);)h.add(y),r.push(_t(y.id)),m=y,y=y.parent;if(y)continue;a=I(a,{status:"done",output:Bs(a,t,e,a.machine.root,m)})}}return a}function Ws(s,t,e,n){for(const i of s){const r=Re(i,t);for(const c of i.target||[])!T(c)&&(i.source!==c||i.source!==r||i.reenter)&&(n.add(c),e.add(c)),U(c,t,e,n);const o=Mt(i,t);for(const c of o){const a=Q(c,r);(r==null?void 0:r.type)==="parallel"&&a.push(r),Pe(n,t,e,a,!i.source.parent&&i.reenter?void 0:r)}}}function U(s,t,e,n){var i;if(T(s))if(t[s.id]){const r=t[s.id];for(const o of r)n.add(o),U(o,t,e,n);for(const o of r)ft(o,s.parent,n,t,e)}else{const r=Ie(s);for(const o of r.target)n.add(o),r===((i=s.parent)==null?void 0:i.initial)&&e.add(s.parent),U(o,t,e,n);for(const o of r.target)ft(o,s.parent,n,t,e)}else if(s.type==="compound"){const[r]=s.initial.target;T(r)||(n.add(r),e.add(r)),U(r,t,e,n),ft(r,s,n,t,e)}else if(s.type==="parallel")for(const r of H(s).filter(o=>!T(o)))[...n].some(o=>A(o,r))||(T(r)||(n.add(r),e.add(r)),U(r,t,e,n))}function Pe(s,t,e,n,i){for(const r of n)if((!i||A(r,i))&&s.add(r),r.type==="parallel")for(const o of H(r).filter(c=>!T(c)))[...s].some(c=>A(c,o))||(s.add(o),U(o,t,e,s))}function ft(s,t,e,n,i){Pe(e,n,i,Q(s,t))}function Gs(s,t,e,n,i,r,o){let c=s;const a=vt(n,i,r);a.sort((l,h)=>h.order-l.order);let d;for(const l of a)for(const h of Hs(l)){let u;h.history==="deep"?u=f=>Ct(f)&&A(f,l):u=f=>f.parent===l,d!=null||(d={...r}),d[h.id]=Array.from(i).filter(u)}for(const l of a)c=L(c,t,e,[...l.exit,...l.invoke.map(h=>xe(h.id))],o),i.delete(l);return[c,d||r]}function Ue(s,t,e,n,i,r){const{machine:o}=s;let c=s;for(const a of n){const d=typeof a=="function",l=d?a:o.implementations.actions[typeof a=="string"?a:a.type];if(!l)continue;const h={context:c.context,event:t,self:e.self,system:e.system},u=d||typeof a=="string"?void 0:"params"in a?typeof a.params=="function"?a.params({context:c.context,event:t}):a.params:void 0;if(!("resolve"in l)){e.self._processingStatus===_.Running?l(h,u):e.defer(()=>{l(h,u)});continue}const f=l,[p,y,m]=f.resolve(e,c,h,u,l,i);c=p,"retryResolve"in f&&(r==null||r.push([f,y])),"execute"in f&&(e.self._processingStatus===_.Running?f.execute(e,y):e.defer(f.execute.bind(null,e,y))),m&&(c=Ue(c,t,e,m,i,r))}return c}function L(s,t,e,n,i,r){const o=r?[]:void 0,c=Ue(s,t,e,n,{internalQueue:i,deferredActorIds:r},o);return o==null||o.forEach(([a,d])=>{a.retryResolve(e,c,d)}),c}function pt(s,t,e,n=[]){let i=s;const r=[];if(t.type===gt)return i=I(Qt(i,t,e),{status:"stopped"}),r.push(i),{snapshot:i,microstates:r};let o=t;if(o.type!==$e){const a=o,d=vs(a),l=te(a,i);if(d&&!l.length)return i=I(s,{status:"error",error:a.error}),r.push(i),{snapshot:i,microstates:r};i=$t(l,s,e,o,!1,n),r.push(i)}let c=!0;for(;i.status==="active";){let a=c?qs(i,o):[];const d=a.length?i:void 0;if(!a.length){if(!n.length)break;o=n.shift(),a=te(o,i)}i=$t(a,i,e,o,!1,n),c=i!==d,r.push(i)}return i.status!=="active"&&Qt(i,o,e),{snapshot:i,microstates:r}}function Qt(s,t,e){return L(s,t,e,Object.values(s.children).map(n=>xe(n)),[])}function te(s,t){return t.machine.getTransitionData(t,s)}function qs(s,t){const e=new Set,n=s._nodes.filter(Ct);for(const i of n)t:for(const r of[i].concat(Q(i,void 0)))if(r.always){for(const o of r.always)if(o.guard===void 0||kt(o.guard,s.context,t,s)){e.add(o);break t}}return Me(Array.from(e),new Set(s._nodes),s.historyValue)}function Ks(s,t){const e=nt(rt(s,t));return Ce(s,[...e])}function Xs(s){return!!s&&typeof s=="object"&&"machine"in s&&"value"in s}const Ys=function(t){return Se(t,this.value)},Vs=function(t){return this.tags.has(t)},Zs=function(t){const e=this.machine.getTransitionData(this,t);return!!(e!=null&&e.length)&&e.some(n=>n.target!==void 0||n.actions.length)},Fs=function(){const{_nodes:t,tags:e,machine:n,getMeta:i,toJSON:r,can:o,hasTag:c,matches:a,...d}=this;return{...d,tags:Array.from(e)}},Qs=function(){return this._nodes.reduce((t,e)=>(e.meta!==void 0&&(t[e.id]=e.meta),t),{})};function et(s,t){return{status:s.status,output:s.output,error:s.error,machine:t,context:s.context,_nodes:s._nodes,value:Ce(t.root,s._nodes),tags:new Set(s._nodes.flatMap(e=>e.tags)),children:s.children,historyValue:s.historyValue||{},matches:Ys,hasTag:Vs,can:Zs,getMeta:Qs,toJSON:Fs}}function I(s,t={}){return et({...s,...t},s.machine)}function tn(s,t){const{_nodes:e,tags:n,machine:i,children:r,context:o,can:c,hasTag:a,matches:d,getMeta:l,toJSON:h,...u}=s,f={};for(const y in r){const m=r[y];f[y]={snapshot:m.getPersistedSnapshot(t),src:m.src,systemId:m._systemId,syncSnapshot:m._syncSnapshot}}return{...u,context:je(o),children:f}}function je(s){let t;for(const e in s){const n=s[e];if(n&&typeof n=="object")if("sessionId"in n&&"send"in n&&"ref"in n)t!=null||(t=Array.isArray(s)?s.slice():{...s}),t[e]={xstate$$type:Tt,id:n.id};else{const i=je(n);i!==n&&(t!=null||(t=Array.isArray(s)?s.slice():{...s}),t[e]=i)}}return t!=null?t:s}function en(s,t,e,n,{event:i,id:r,delay:o},{internalQueue:c}){const a=t.machine.implementations.delays;if(typeof i=="string")throw new Error(`Only event objects may be used with raise; use raise({ type: "${i}" }) instead`);const d=typeof i=="function"?i(e,n):i;let l;if(typeof o=="string"){const h=a&&a[o];l=typeof h=="function"?h(e,n):h}else l=typeof o=="function"?o(e,n):o;return typeof l!="number"&&c.push(d),[t,{event:d,id:r,delay:l}]}function sn(s,t){const{event:e,delay:n,id:i}=t;if(typeof n=="number"){s.defer(()=>{const r=s.self;s.system.scheduler.schedule(r,r,e,n,i)});return}}function nn(s,t){function e(n,i){}return e.type="xstate.raise",e.event=s,e.id=t==null?void 0:t.id,e.delay=t==null?void 0:t.delay,e.resolve=en,e.execute=sn,e}function rn(s,{machine:t,context:e},n,i){const r=(o,c={})=>{const{systemId:a,input:d}=c;if(typeof o=="string"){const l=xt(t,o);if(!l)throw new Error(`Actor logic '${o}' not implemented in machine '${t.id}'`);const h=Z(l,{id:c.id,parent:s.self,syncSnapshot:c.syncSnapshot,input:typeof d=="function"?d({context:e,event:n,self:s.self}):d,src:o,systemId:a});return i[h.id]=h,h}else return Z(o,{id:c.id,parent:s.self,syncSnapshot:c.syncSnapshot,input:c.input,src:o,systemId:a})};return(o,c)=>{const a=r(o,c);return i[a.id]=a,s.defer(()=>{a._processingStatus!==_.Stopped&&a.start()}),a}}function on(s,t,e,n,{assignment:i}){if(!t.context)throw new Error("Cannot assign to undefined `context`. Ensure that `context` is defined in the machine config.");const r={},o={context:t.context,event:e.event,spawn:rn(s,t,e.event,r),self:s.self,system:s.system};let c={};if(typeof i=="function")c=i(o,n);else for(const d of Object.keys(i)){const l=i[d];c[d]=typeof l=="function"?l(o,n):l}const a=Object.assign({},t.context,c);return[I(t,{context:a,children:Object.keys(r).length?{...t.children,...r}:t.children})]}function bt(s){function t(e,n){}return t.type="xstate.assign",t.assignment=s,t.resolve=on,t}const ee=new WeakMap;function M(s,t,e){let n=ee.get(s);return n?t in n||(n[t]=e()):(n={[t]:e()},ee.set(s,n)),n[t]}const cn={},J=s=>typeof s=="string"?{type:s}:typeof s=="function"?"resolve"in s?{type:s.type}:{type:s.name}:s;class Rt{constructor(t,e){if(this.config=t,this.key=void 0,this.id=void 0,this.type=void 0,this.path=void 0,this.states=void 0,this.history=void 0,this.entry=void 0,this.exit=void 0,this.parent=void 0,this.machine=void 0,this.meta=void 0,this.output=void 0,this.order=-1,this.description=void 0,this.tags=[],this.transitions=void 0,this.always=void 0,this.parent=e._parent,this.key=e._key,this.machine=e._machine,this.path=this.parent?this.parent.path.concat(this.key):[],this.id=this.config.id||[this.machine.id,...this.path].join(me),this.type=this.config.type||(this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.description=this.config.description,this.order=this.machine.idMap.size,this.machine.idMap.set(this.id,this),this.states=this.config.states?Yt(this.config.states,(n,i)=>new Rt(n,{_parent:this,_key:i,_machine:this.machine})):cn,this.type==="compound"&&!this.config.initial)throw new Error(`No initial state specified for compound state node "#${this.id}". Try adding { initial: "${Object.keys(this.states)[0]}" } to the state config.`);this.history=this.config.history===!0?"shallow":this.config.history||!1,this.entry=b(this.config.entry).slice(),this.exit=b(this.config.exit).slice(),this.meta=this.config.meta,this.output=this.type==="final"||!this.parent?this.config.output:void 0,this.tags=b(t.tags).slice()}_initialize(){this.transitions=Ms(this),this.config.always&&(this.always=P(this.config.always).map(t=>E(this,ve,t))),Object.keys(this.states).forEach(t=>{this.states[t]._initialize()})}get definition(){return{id:this.id,key:this.key,version:this.machine.version,type:this.type,initial:this.initial?{target:this.initial.target,source:this,actions:this.initial.actions.map(J),eventType:null,reenter:!1,toJSON:()=>({target:this.initial.target.map(t=>`#${t.id}`),source:`#${this.id}`,actions:this.initial.actions.map(J),eventType:null})}:void 0,history:this.history,states:Yt(this.states,t=>t.definition),on:this.on,transitions:[...this.transitions.values()].flat().map(t=>({...t,actions:t.actions.map(J)})),entry:this.entry.map(J),exit:this.exit.map(J),meta:this.meta,order:this.order||-1,output:this.output,invoke:this.invoke,description:this.description,tags:this.tags}}toJSON(){return this.definition}get invoke(){return M(this,"invoke",()=>b(this.config.invoke).map((t,e)=>{var c;const{src:n,systemId:i}=t,r=(c=t.id)!=null?c:Zt(this.id,e),o=typeof n=="string"?n:`xstate.invoke.${Zt(this.id,e)}`;return{...t,src:o,id:r,systemId:i,toJSON(){const{onDone:a,onError:d,...l}=t;return{...l,type:"xstate.invoke",src:o,id:r}}}}))}get on(){return M(this,"on",()=>[...this.transitions].flatMap(([e,n])=>n.map(i=>[e,i])).reduce((e,[n,i])=>(e[n]=e[n]||[],e[n].push(i),e),{}))}get after(){return M(this,"delayedTransitions",()=>Os(this))}get initial(){return M(this,"initial",()=>Rs(this,this.config.initial))}next(t,e){const n=e.type,i=[];let r;const o=M(this,`candidates-${n}`,()=>Is(this,n));for(const c of o){const{guard:a}=c,d=t.context;let l=!1;try{l=!a||kt(a,d,e,t)}catch(h){const u=typeof a=="string"?a:typeof a=="object"?a.type:void 0;throw new Error(`Unable to evaluate guard ${u?`'${u}' `:""}in transition for event '${n}' in state node '${this.id}':
${h.message}`)}if(l){i.push(...c.actions),r=c;break}}return r?[r]:void 0}get events(){return M(this,"events",()=>{const{states:t}=this,e=new Set(this.ownEvents);if(t)for(const n of Object.keys(t)){const i=t[n];if(i.states)for(const r of i.events)e.add(`${r}`)}return Array.from(e)})}get ownEvents(){const t=new Set([...this.transitions.keys()].filter(e=>this.transitions.get(e).some(n=>!(!n.target&&!n.actions.length&&!n.reenter))));return Array.from(t)}}const an="#";class Pt{constructor(t,e){var n,i,r,o;this.config=t,this.version=void 0,this.implementations=void 0,this.__xstatenode=!0,this.idMap=new Map,this.root=void 0,this.id=void 0,this.states=void 0,this.events=void 0,this.__TResolvedTypesMeta=void 0,this.id=t.id||"(machine)",this.implementations={actors:(n=e==null?void 0:e.actors)!=null?n:{},actions:(i=e==null?void 0:e.actions)!=null?i:{},delays:(r=e==null?void 0:e.delays)!=null?r:{},guards:(o=e==null?void 0:e.guards)!=null?o:{}},this.version=this.config.version,this.transition=this.transition.bind(this),this.getInitialSnapshot=this.getInitialSnapshot.bind(this),this.getPersistedSnapshot=this.getPersistedSnapshot.bind(this),this.restoreSnapshot=this.restoreSnapshot.bind(this),this.start=this.start.bind(this),this.root=new Rt(t,{_key:this.id,_machine:this}),this.root._initialize(),this.states=this.root.states,this.events=this.root.events}provide(t){const{actions:e,guards:n,actors:i,delays:r}=this.implementations;return new Pt(this.config,{actions:{...e,...t.actions},guards:{...n,...t.guards},actors:{...i,...t.actors},delays:{...r,...t.delays}})}resolveState(t){const e=Ks(this.root,t.value),n=nt(rt(this.root,e));return et({_nodes:[...n],context:t.context||{},children:{},status:It(n,this.root)?"done":t.status||"active",output:t.output,error:t.error,historyValue:t.historyValue},this)}transition(t,e,n){return pt(t,e,n).snapshot}microstep(t,e,n){return pt(t,e,n).microstates}getTransitionData(t,e){return Ot(this.root,t.value,t,e)||[]}getPreInitialState(t,e,n){const{context:i}=this.config,r=et({context:typeof i!="function"&&i?i:{},_nodes:[this.root],children:{},status:"active"},this);return typeof i=="function"?L(r,e,t,[bt(({spawn:c,event:a,self:d})=>i({spawn:c,input:a.input,self:d}))],n):r}getInitialSnapshot(t,e){const n=be(e),i=[],r=this.getPreInitialState(t,n,i),o=$t([{target:[...Oe(this.root)],source:this.root,reenter:!0,actions:[],eventType:null,toJSON:null}],r,t,n,!0,i),{snapshot:c}=pt(o,n,t,i);return c}start(t){Object.values(t.children).forEach(e=>{e.getSnapshot().status==="active"&&e.start()})}getStateNodeById(t){const e=Et(t),n=e.slice(1),i=ct(e[0])?e[0].slice(an.length):e[0],r=this.idMap.get(i);if(!r)throw new Error(`Child state node '#${i}' does not exist on machine '${this.id}'`);return it(r,n)}get definition(){return this.root.definition}toJSON(){return this.definition}getPersistedSnapshot(t,e){return tn(t,e)}restoreSnapshot(t,e){const n={},i=t.children;Object.keys(i).forEach(a=>{const d=i[a],l=d.snapshot,h=d.src,u=typeof h=="string"?xt(this,h):h;if(!u)return;const f=Z(u,{id:a,parent:e.self,syncSnapshot:d.syncSnapshot,snapshot:l,src:h,systemId:d.systemId});n[a]=f});const r=et({...t,children:n,_nodes:Array.from(nt(rt(this.root,t.value)))},this);let o=new Set;function c(a,d){if(!o.has(a)){o.add(a);for(let l in a){const h=a[l];if(h&&typeof h=="object"){if("xstate$$type"in h&&h.xstate$$type===Tt){a[l]=d[h.id];continue}c(h,d)}}}}return c(r.context,n),r}}function hn(s,t){return new Pt(s,t)}class dn{constructor(t,e,n){(this.host=t).addController(this),this.service=Z(e).start(),this.propKey=n}get state(){return this.service.getSnapshot()}send(t){this.service.send(t)}hostConnected(){this.service.subscribe(t=>{this.propKey in this.host&&(this.host[this.propKey]=t)})}hostDisconnected(){this.service.stop()}}const se={enabled:"enabled",disabled:"disabled"},ln={counter:({context:s})=>s.counter+1,event:({event:s})=>s},un={counter:({context:s})=>s.counter-1,event:({event:s})=>s},fn=({context:s})=>s.counter<10,pn=({context:s})=>s.counter>0,yn=hn({id:"counter",context:{counter:0,event:void 0},initial:"enabled",states:{enabled:{on:{INC:{actions:{type:"increment"},guard:{type:"isNotMax"}},DEC:{actions:{type:"decrement"},guard:{type:"isNotMin"}},TOGGLE:{target:se.disabled}}},disabled:{on:{TOGGLE:{target:se.enabled}}}}},{actions:{increment:bt(ln),decrement:bt(un)},guards:{isNotMax:fn,isNotMin:pn}}),gn=Be`:host {
  --_mark-color: rgb(197, 197, 197);
  display: block;
  box-sizing: border-box;
}

:host([hidden]),
[hidden] {
  display: none !important;
}

*,
*::before,
*::after {
  box-sizing: inherit;
}

[aria-disabled=true] {
  opacity: 0.5;
  -webkit-user-select: none;
     -moz-user-select: none;
          user-select: none;
  pointer-events: none;
  cursor: default;
}

p {
  font-size: 1.5rem;
  min-width: 4.25rem;
  text-align: center;
  margin: auto;
  padding: 0.8333em;
  background-color: var(--_mark-color);
}

button {
  display: inline-block;
  min-width: 9.375rem;
  font: inherit;
  cursor: pointer;
  white-space: nowrap;
  border: none;
  color: rgb(245, 245, 245);
  background-color: rgb(51, 65, 85);
  padding: 0.75em;
}
button:first-child:not(:only-child) {
  margin-bottom: 1rem;
}

div {
  display: flex;
  align-items: center;
  max-width: 25rem;
  padding: 1em 2em;
  margin: auto;
  background-color: rgb(238, 238, 238);
  border: 0.0625rem solid var(--_mark-color);
  border-bottom: none;
}
div + div {
  border-top: 0.0625rem dashed var(--_mark-color);
  border-bottom: 0.0625rem solid var(--_mark-color);
}

span {
  display: flex;
  flex-direction: column;
  margin-right: 2rem;
}

::slotted(*) {
  white-space: nowrap;
}`;var k,W;class St extends K{constructor(){super();Ut(this,k);this._xstate={},this.counterController=new dn(this,yn,"_xstate")}updated(e){if(super.updated&&super.updated(e),e.has("_xstate")){const{context:n,value:i}=this._xstate,r=new CustomEvent("counterchange",{bubbles:!0,detail:{...n,value:i}});this.dispatchEvent(r)}}render(){return ye`
      <slot></slot>
      <div aria-disabled="${N(this,k,W)}">
        <span>
          <button
            ?disabled="${N(this,k,W)}"
            data-counter="increment"
            @click=${()=>this.counterController.send({type:"INC"})}
          >
            Increment
          </button>
          <button
            ?disabled="${N(this,k,W)}"
            data-counter="decrement"
            @click=${()=>this.counterController.send({type:"DEC"})}
          >
            Decrement
          </button>
        </span>
        <p>${this.counterController.state.context.counter}</p>
      </div>
      <div>
        <button @click=${()=>this.counterController.send({type:"TOGGLE"})}>
          ${N(this,k,W)?"Enabled counter":"Disabled counter"}
        </button>
      </div>
    `}}k=new WeakSet,W=function(){return this.counterController.state.matches("disabled")},at(St,"properties",{_xstate:{type:Object,state:!0}}),at(St,"styles",[gn]);window.customElements.define("xstate-counter",St);_e(ye` <xstate-counter @counterchange="${s=>console.log("==>",s.detail)}">
          <h1>
            State machine with
            <a target="_blank" rel="noopener noreferrer" href="https://stately.ai/docs/installation"
              >XState</a
            >
            and
            <a
              href="https://lit.dev/docs/composition/controllers/"
              target="_blank"
              rel="noopener noreferrer"
              >Lit Controller</a
            >
          </h1>
        </xstate-counter>`,document.querySelector("body"));
